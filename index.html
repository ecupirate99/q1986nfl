<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NFL 1986 Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; }
    h1 { color: #003366; font-size: 1.5em; }
    form { margin-bottom: 20px; }
    label { display: block; margin-bottom: 10px; }
    input, select, button { width: 100%; padding: 8px; margin-top: 4px; font-size: 1em; }
    button { margin-top: 10px; }
    .layout { display: flex; gap: 20px; }
    .filters { width: 220px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; font-size: 0.9em; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; cursor: pointer; }
    th { background-color: #f2f2f2; }
    th.sort-asc::after { content: " ‚ñ≤"; }
    th.sort-desc::after { content: " ‚ñº"; }
    @media (max-width: 768px) {
      .layout { flex-direction: column; }
      .filters { width: 100%; }
      table { display: block; overflow-x: auto; white-space: nowrap; }
      th, td { padding: 10px; }
    }
  </style>
</head>
<body>
  <h1>üèà NFL 1986 Offensive Player Stats</h1>

  <form id="queryForm">
    <div class="layout">
      <div class="filters">
        <label>Player Name:<input type="text" name="name"></label>

        <label>Team:
          <select name="team">
            <option value="">-- Select Team --</option>
            <option value="49ers">49ers</option>
            <option value="Bears">Bears</option>
            <option value="Bengals">Bengals</option>
            <option value="Bills">Bills</option>
            <option value="Broncos">Broncos</option>
            <option value="Browns">Browns</option>
            <option value="Buccaneers">Buccaneers</option>
            <option value="Cardinals">Cardinals</option>
            <option value="Chargers">Chargers</option>
            <option value="Chiefs">Chiefs</option>
            <option value="Colts">Colts</option>
            <option value="Cowboys">Cowboys</option>
            <option value="Dolphins">Dolphins</option>
            <option value="Eagles">Eagles</option>
            <option value="Falcons">Falcons</option>
            <option value="Giants">Giants</option>
            <option value="Jets">Jets</option>
            <option value="Lions">Lions</option>
            <option value="Oilers">Oilers</option>
            <option value="Packers">Packers</option>
            <option value="Patriots">Patriots</option>
            <option value="Raiders">Raiders</option>
            <option value="Rams">Rams</option>
            <option value="Redskins">Redskins</option>
            <option value="Saints">Saints</option>
            <option value="Seahawks">Seahawks</option>
            <option value="Steelers">Steelers</option>
            <option value="Vikings">Vikings</option>
          </select>
        </label>

        <label>Position:
          <select name="pos">
            <option value="">-- Select Position --</option>
            <option value="QB">QB</option>
            <option value="RB">RB</option>
            <option value="TE">TE</option>
            <option value="WR">WR</option>
          </select>
        </label>

        <label>Min Yards:<input type="number" name="minYds"></label>
        <label>Min TD:<input type="number" name="minTD"></label>
        <button type="submit">Search</button>
        <button type="button" id="clearBtn">Clear</button>
      </div>

      <div style="flex:1;">
        <table id="resultsTable">
          <thead>
            <tr>
              <th data-key="Player">Player</th>
              <th data-key="Team">Team</th>
              <th data-key="Pos">Pos</th>
              <th data-key="G">G</th>
              <th data-key="Cmp">Cmp</th>
              <th data-key="Att">Att</th>
              <th data-key="Yds">Yds</th>
              <th data-key="TD">TD</th>
              <th data-key="Int">Int</th>
              <th data-key="Rate">Rate</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById('queryForm');
      const tableBody = document.querySelector('#resultsTable tbody');
      const clearBtn = document.getElementById('clearBtn');
      const headers = document.querySelectorAll('#resultsTable th');
      let lastResults = [];
      let sortState = {};

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const res = await fetch("players.json");
        const players = await res.json();
        const params = Object.fromEntries(new FormData(form).entries());
        let results = players;

        // Apply filters
        if (params.name) {
          results = results.filter(p => p.Player && p.Player.toLowerCase().includes(params.name.toLowerCase()));
        }
        if (params.team) {
          results = results.filter(p => p.Team && p.Team.toLowerCase().includes(params.team.toLowerCase()));
        }
        if (params.pos) {
          results = results.filter(p => {
            const pos = p.Pos ? p.Pos.toLowerCase() : "";
            if (params.pos.toLowerCase() === "qb") return pos.includes("qb") || pos.includes("quarterback");
            if (params.pos.toLowerCase() === "rb") return pos.includes("rb") || pos.includes("running");
            if (params.pos.toLowerCase() === "wr") return pos.includes("wr") || pos.includes("wide");
            if (params.pos.toLowerCase() === "te") return pos.includes("te") || pos.includes("tight");
            return false;
          });
        }
        if (params.minYds) {
          results = results.filter(p => parseFloat(p.Yds || 0) >= parseFloat(params.minYds));
        }
        if (params.minTD) {
          results = results.filter(p => parseInt(p.TD || 0) >= parseInt(params.minTD));
        }

        // Default sort by Yds descending
        results = results.sort((a, b) => parseFloat(b.Yds || 0) - parseFloat(a.Yds || 0));

        lastResults = results;
        renderResults(results);
      });

      clearBtn.addEventListener('click', () => {
        form.reset();
        tableBody.innerHTML = "";
        lastResults = [];
        headers.forEach(h => h.classList.remove("sort-asc", "sort-desc"));
        sortState = {};
      });

      headers.forEach(header => {
        header.addEventListener('click', () => {
          if (!lastResults.length) return;
          const key = header.dataset.key;
          const isNumeric = ["G","Cmp","Att","Yds","TD","Int","Rate"].includes(key);
          const direction = sortState[key] === "asc" ? "desc" : "asc";
          sortState = {};
          sortState[key] = direction;

          headers.forEach(h => h.classList.remove("sort-asc","sort-desc"));
          header.classList.add(direction === "asc" ? "sort-asc" : "sort-desc");

          lastResults.sort((a,b) => {
            const valA = isNumeric ? parseFloat(a[key] || 0) : String(a[key] || "");
            const valB = isNumeric ? parseFloat(b[key] || 0) : String(b[key]
