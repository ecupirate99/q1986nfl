<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>NFL 1986 Stats</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial, sans-serif; margin: 10px; }
    h1 { color: #003366; font-size: 1.5em; }
    form { margin-bottom: 20px; }
    label { display: block; margin-bottom: 10px; }
    input, select, button { width: 100%; padding: 8px; margin-top: 4px; font-size: 1em; }
    button { margin-top: 10px; }
    .layout { display: flex; gap: 20px; }
    .filters { width: 220px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; font-size: 0.9em; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; cursor: pointer; }
    th { background-color: #f2f2f2; }
    th.sort-asc::after { content: " ‚ñ≤"; }
    th.sort-desc::after { content: " ‚ñº"; }
    @media (max-width: 768px) {
      .layout { flex-direction: column; }
      .filters { width: 100%; }
      table { display: block; overflow-x: auto; white-space: nowrap; }
      th, td { padding: 10px; }
    }
    .hint { color: #666; font-size: 0.9em; margin-top: 4px; }
  </style>
</head>
<body>
  <h1>üèà NFL 1986 Offensive Player Stats</h1>

  <!-- Ask a question -->
  <form id="queryForm">
    <label>Ask a question:</label>
    <input type="text" id="question" name="question" placeholder="e.g. Top 5 RB by yardage">
    <div class="hint">Examples: ‚ÄúTop 5 RB by yardage‚Äù, ‚ÄúTop 10 WR by touchdowns‚Äù, ‚ÄúTeam Dolphins top 3 by yards‚Äù, ‚ÄúRank QBs by rating‚Äù.</div>
    <br>

    <div class="layout">
      <!-- Filters stacked vertically -->
      <div class="filters">
        <label>Player Name:<input type="text" name="name"></label>
        
        <label>Team:
          <select name="team">
            <option value="">-- Select Team --</option>
            <option value="Bears">Bears</option>
            <option value="Bengals">Bengals</option>
            <option value="Bills">Bills</option>
            <option value="Broncos">Broncos</option>
            <option value="Browns">Browns</option>
            <option value="Buccaneers">Buccaneers</option>
            <option value="Cardinals">Cardinals</option>
            <option value="Chargers">Chargers</option>
            <option value="Chiefs">Chiefs</option>
            <option value="Colts">Colts</option>
            <option value="Cowboys">Cowboys</option>
            <option value="Dolphins">Dolphins</option>
            <option value="Eagles">Eagles</option>
            <option value="Falcons">Falcons</option>
            <option value="Giants">Giants</option>
            <option value="Jets">Jets</option>
            <option value="Lions">Lions</option>
            <option value="Oilers">Oilers</option>
            <option value="Packers">Packers</option>
            <option value="Patriots">Patriots</option>
            <option value="Raiders">Raiders</option>
            <option value="Rams">Rams</option>
            <option value="Redskins">Redskins</option>
            <option value="Saints">Saints</option>
            <option value="Seahawks">Seahawks</option>
            <option value="Steelers">Steelers</option>
            <option value="Vikings">Vikings</option>
            <option value="49ers">49ers</option>
          </select>
        </label>

        <label>Position:<input type="text" name="pos" placeholder="QB, RB, WR, TE"></label>
        <label>Min Yards:<input type="number" name="minYds"></label>
        <label>Min TD:<input type="number" name="minTD"></label>
        <button type="submit">Search</button>
        <button type="button" id="clearBtn">Clear</button>
      </div>

      <!-- Results table -->
      <div style="flex:1;">
        <table id="resultsTable">
          <thead>
            <tr>
              <th data-key="Player">Player</th>
              <th data-key="Team">Team</th>
              <th data-key="Pos">Pos</th>
              <th data-key="G">G</th>
              <th data-key="Cmp">Cmp</th>
              <th data-key="Att">Att</th>
              <th data-key="Yds">Yds</th>
              <th data-key="TD">TD</th>
              <th data-key="Int">Int</th>
              <th data-key="Rate">Rate</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById('queryForm');
      const tableBody = document.querySelector('#resultsTable tbody');
      const clearBtn = document.getElementById('clearBtn');
      const headers = document.querySelectorAll('#resultsTable th');
      let lastResults = [];
      let sortState = {};

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const res = await fetch("players.json");
        const players = await res.json();
        const params = Object.fromEntries(new FormData(form).entries());
        let results = players;

        // Apply filters
        if (params.name) results = results.filter(p => p.Player && p.Player.toLowerCase().includes(params.name.toLowerCase()));
        if (params.team) results = results.filter(p => p.Team && p.Team.toLowerCase() === params.team.toLowerCase());
        if (params.pos) results = results.filter(p => p.Pos && p.Pos.toLowerCase() === params.pos.toLowerCase());
        if (params.minYds) results = results.filter(p => parseFloat(p.Yds || 0) >= parseFloat(params.minYds));
        if (params.minTD) results = results.filter(p => parseInt(p.TD || 0) >= parseInt(params.minTD));

        lastResults = results;
        renderResults(results);
      });

      clearBtn.addEventListener('click', () => {
        form.reset();
        tableBody.innerHTML = "";
        lastResults = [];
        headers.forEach(h => h.classList.remove("sort-asc", "sort-desc"));
        sortState = {};
      });

      headers.forEach(header => {
        header.addEventListener('click', () => {
          if (!lastResults.length) return;
          const key = header.dataset.key;
          const isNumeric = ["G","Cmp","Att","Yds","TD","Int","Rate"].includes(key);
          const direction = sortState[key] === "asc" ? "desc" : "asc";
          sortState = {};
          sortState[key] = direction;

          headers.forEach(h => h.classList.remove("sort-asc","sort-desc"));
          header.classList.add(direction === "asc" ? "sort-asc" : "sort-desc");

          lastResults.sort((a,b) => {
            const valA = isNumeric ? parseFloat(a[key] || 0) : String(a[key] || "");
            const valB = isNumeric ? parseFloat(b[key] || 0) : String(b[key] || "");
            if (isNumeric) {
              return direction === "asc" ? valA - valB : valB - valA;
            } else {
              return direction === "asc" ? valA.localeCompare(valB) : valB.localeCompare(valA);
            }
          });

          renderResults(lastResults);
        });
      });

      function renderResults(results) {
        tableBody.innerHTML = "";
        if (!results.length) {
          tableBody.innerHTML = "<tr><td colspan='10'>No results found</td></tr>";
          return;
        }
        results.forEach(p => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${p.Player || ""}</td>
            <td>${p.Team || ""}</td>
            <td>${p.Pos || ""}</td>
            <td>${p.G || ""}</td>
